<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Meta -->
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Instructor - Review Request</title>

	<!--
    Author: James La Fontaine
    Date Last Modified: September 30, 2023
    Description: This is the page on which instructors can review a selected active request
    -->

	<!-- CSS stylesheets -->
    <style>
        .pageAsATable {
            display: grid;
            grid-template-columns: 70% 1fr;
        }

        /* CSS to hide the button */
        #myButton.hidden {
            display: none;
        }
    </style>

	<link rel="stylesheet" href="../css/general.css">
	<link rel="stylesheet" href="../css/header.css">
	<link rel="stylesheet" href="../css/tables.css">
    <link rel="stylesheet" href="../css/popups.css">



	<!-- Include Bootstrap CSS and JavaScript, and its dependencies such as Popper. Also include jQuery JavaScript -->

	<!-- Bootstrap CSS and JavaScript provided by Bootstrap. Visit https://getbootstrap.com/ for more information. -->
	<!-- jQuery and Popper JavaScript provided by jQuery and PopperJS. Visit https://jquery.com/ and https://popperjs.com/ for more information. -->
	<link 
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" 
	rel="stylesheet" 
	integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" 
	crossorigin="anonymous">

	<!-- JS scripts -->
	<script type="text/javascript"
	src="https://code.jquery.com/jquery-3.7.1.min.js"
	integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
	crossorigin="anonymous"></script>
	<script type="text/javascript"
	src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.2/umd/popper.min.js" 
	integrity="sha512-2rNj2KJ+D8s1ceNasTIex6z4HWyOnEYLVC3FigGOmyQCZc2eBXKgOxQmo3oKLHyfcj53uz4QMsRCWNbLd32Q1g==" 
	crossorigin="anonymous" 
	referrerpolicy="no-referrer"></script>
	<script type="text/javascript" 
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" 
	integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" 
	crossorigin="anonymous"></script>

    <!-- <script> 
    $(function(){
      $("#includedContent").load("popup.html"); 
    });
    </script>  -->
  </head> 
</head>
<body>
    
    <div id="webHeaderContainer"></div>
    
    <!----------------------------- Popup HTML starts here ----------------------------->

    <div id="approvePopup" class="popupBox">
        <div class="popupContent">
            <div class="popupHeaderBox">
                <span class="popupHeaderContents">Approve Request
                    <button class="closePopup" style="justify-self:end">X</button>
                </span>
            </div>
            <div class="popupBody">
                <br>
                <div style="text-align:center">
                    <p class="text">Instructor Notes</p>
                    <textarea class="textBox" id="instructorNotesA" placeholder="Enter your reasoning here..." style="margin: 10px; width:80%; height:90px; resize:none"></textarea>
                </div>
                <br>
                <div style="text-align:center">
                    <span class="text" style="margin:10px">Current Deadline</span>
                    <span class="text" style="margin:10px">Default Extension</span>
                    <br>
                    <textarea class="textBox" id="currentDeadline" style="margin-right: 30px; margin-top: 10px; width:20%; height:30px; resize:none; text-align:center" readonly></textarea>
                    <textarea class="textBox" id="defaultExtension" style="margin-left: 30px; margin-top: 10px; width:20%; height:30px; resize:none; text-align:center" readonly>Project 1</textarea>
                </div>
                <div style="text-align:center">
                    <br><br>
                    <label for="extensionOverride">Override Extension:</label>
                    <select id="extensionOverrideA">
                    </select>
                    <span class="text" style="font-weight:normal">day(s)</span>
                </div>
                </div>
                <br><br>
                <div style="text-align:center">
                    <p class="text">Student Selected Assessment</p>
                    <textarea class="textBox" id="selectedAssessmentA" style="margin: 10px; width:20%; height:30px; resize:none; text-align:center" readonly>Project 1</textarea>
                </div>
                <br>
                <div style="text-align:center">
                    <label for="assessmentOverride">Override Assessment:</label>
                    <select class="assessmentOverride" id="assessmentOverrideA">
                    </select>
                </div>
                <br><br>
                <div class="popupButton" id="popupApproveButton">Approve Request</div>
                <br>
            </div>
        </div>
    </div>
    
    <div id="rejectPopup" class="popupBox">
        <div class="popupContent">
            <div class="popupHeaderBox">
                <span class="popupHeaderContents">Reject Request
                    <button class="closePopup" style="justify-self:end">X</button>
                </span>
            </div>
            <div class="popupBody">
                <br>
                <div style="text-align:center">
                    <p class="text">Instructor Notes</p>
                    <textarea class="textBox" id="instructorNotesR" placeholder="Enter your reasoning here..." style="margin: 10px; width:80%; height:90px; resize:none"></textarea>
                </div>
                <br>
                
                <div style="text-align:center">
                    <p class="text">Student Selected Assessment</p>
                    <textarea class="textBox" id="selectedAssessmentR" style="margin: 10px; width:20%; height:30px; resize:none; text-align:center" readonly>Project 1</textarea>
                </div>
                <br>
                <div style="text-align:center">
                    <label for="assessmentOverride">Override Assessment:</label>
                    <select class="assessmentOverride" id="assessmentOverrideR">
                    </select>
                </div>
                <br><br>
                <div class="popupButton" id="popupRejectButton">Reject Request</div>
                <br>
            </div>
        </div>
    </div>

    <!----------------------------- Popup HTML ends here ----------------------------->

    <div class="mainBody" style="width: 90%;">

        <div class="pageAsATable">
            
            <div class="leftSide">
                <p class="title" id="requestNum"></p>
                <p class="title" id="versionNum" style="font-size:25px"></p>
                <p class="text" id="dates"></p>
                <br>
                <p class="text">Course</p>
                <textarea class="textBox" id="course" style="height:30px; resize:none" readonly></textarea>

                <p class="text">Assessment</p>
                <textarea class="textBox" id="assessment" style="height:30px; resize:none" readonly></textarea>

                <p class="text">Request Type</p>
                <textarea class="textBox" id="requestType" style="height:30px; resize:none" readonly></textarea>

                <p class="text">Request Title</p>
                <textarea class="textBox" id="requestTitle" style="height:30px; resize:none" readonly></textarea>

                <p class="text">Message</p>
                <textarea class="textBox" id="message" style="height:120px; resize:none" readonly>
                </textarea>

                <p class="text">Status</p>
                <textarea class="textBox" id="status" style="height:30px; resize:none" readonly></textarea>
                
                <p></p>

                <p class="text">Supporting Documents</p>

                <div id="suppDocContainer">
                    <table>
                        <!-- Supporting documentation will be dynamically added here -->
                    </table>
                </div>

                <br><br>

                <p class="title" style="font-size:24px">Request History</p>

                <div id="requestHistoryContainer">
                    <!-- Request history will be added here dynamically -->
                </div>

            </div>

            <div class="rightSide" style="text-align: center;">
                <br><br>
                <p class="title" style="font-size: 24px; text-align: center;">Student Details</p>
                <div style="display: inline-block; text-align: center;">
                    <p class="standardBox" style="width: 300px; height: 200px;">
                        <span class="text" id="studentName"></span>
                        <span class="text" id="studentId"></span>
                        <span class="text" id="studentEmail" style="font-size: 14px;"></span>
                        <span>
                            <button class="standardButton" onclick="window.location.href='iViewProfile.html'">
                                View Profile
                            </button>
                        </span>
                    </p>
                </div>
                <br><br><br><br>
                <div style="text-align: center; width: fit-content; margin: 0 auto;">
                    <div>
                        <p class="bigButton" id="reserveButton">
                            Mark as complex
                        </p>
                        <div>
                            <p class="bigButton" id="approveButton" data-target="approvePopup">
                                Approve Request
                            </p>
                        </div>
                        <div>
                            <p class="bigButton" id="rejectButton" data-target="rejectPopup">
                                Reject Request
                            </p>
                        </div>
                        <p class="bigButton" onclick="window.location.href='iViewRequests.html'">
                            Back
                        </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="../js/modules/iWebHeader.js"></script>
    <script src="../js/modules/requests.js"></script>
    <script src="../js/modules/buttons.js"></script>
    <script>
        var req1 = {
            requestId: 123456,
            creationDate: '10/10/2012',
            resolveDate: '',
            reserved: false,
            course: 'COMP30022 - IT Project',
            assessment: 'Project 1',
            requestType: 'Extension',
            requestTitle: 'Project 1 Extension Request',
            message: 'I am sick ;\'( why must misfortune happen to me',
            status: 'Waiting for action'
        };

        const suppDocs = [
            {
                name: 'iamsick.pdf',
                size: '20 TB'
            },
            {
                name: 'bible.pdf',
                size: '40 MB'
            },
            {
                name: 'medcert.pdf',
                size: '3 MB'
            }
        ]

        const prevVersions = [
            {
                date: "2011/09/24",
                message: "The power has died!! :(",
                documents: [
                    { name: "iamsick.pdf", size: "20 TB" },
                    { name: "bible.pdf", size: "40 MB" }
                ]
            },
            {
                date: "2011/09/23",
                message: "Haven't thought of an excuse yet.",
                documents: [
                    { name: "bible.pdf", size: "40 MB" }
                ]
            }
        ];
        

        // Fill information relating to the current request from the database
        fillCurrentRequestInformation(req1, prevVersions.length + 1);

        // Generate the supporting documentation for the current version of request
        generateSuppDocTable(suppDocs, '');

        // Generate version boxes for all previous request versions in the database
        for (let i = 0; i < prevVersions.length; i++) {
            generateVersionBox(prevVersions[i], prevVersions.length - i)
        }

        handleComplexRequestFunctionality(req1);

    </script>
    <script src="../js/modules/popups.js"></script>

    <!-- Popup related JS -->
    <script>
        
        
        
        document.addEventListener('DOMContentLoaded', function () {

            // Handle all popup JS
            setupOpenClosePopupButtons();
        
            var req1 = {
                requestId: 123456,
                creationDate: '10/10/2012',
                resolveDate: '',
                reserved: false,
                course: 'COMP30022 - IT Project',
                assessment: 'Project 1',
                requestType: 'Extension',
                requestTitle: 'Project 1 Extension Request',
                message: 'I am sick ;\'( why must misfortune happen to me',
                status: 'Waiting for action',
                instructorNotes: '',
                dueDate: '2012/10/15',
                defaultExtension: 3,
                maxExtension: 10,
                approvedExtension: 0
            };
            
            // List of assessments
            const assessments = ['Project 1', 'Project 2', 'Mid Semester Test'];

            populatePopups(req1, assessments);
            
            handleApprovalAndRejection(req1);
        });
    </script>
    <!-- Student Details Box Population -->
    <script src="../js/modules/studentDetails.js"></script>
    <script>
        student = {
            firstName: 'Callum',
            lastName: 'Sharman',
            id: 1178429,
            email: 'csharman@student.unimelb.edu.au'
        }

        fillStudentDetailsBox(student);
    </script>
</body>
</html>
